##### Для запуска тестов необходимо использовать файл make_sim.do. Внутри него закомментированы 5 наборов тестов, нужно раскомментировать любой один из них и запустить симуляцию. При тестировании весь лог выводится без перерывов, все ошибки "сыпятся" в консоль, что очень сильно тормозит симуляцию. Поэтому для глубокого тестирования лучше модернизировать ./tb/macros.sv путем замены display на error/stop или просто раскомментировать комментарий $stop в макросе SHOW_WRONG_SIGNALS, чтобы прекратить симуляцию в случае первой же ошибки. 
---
##### Все тесты, кроме BIG_TEST, написаны для наглядности. При этом они отъедают значимую часть времени работы тестов.
---
> BIG_TEST можно модернизировать: в файле ./tb/ast_we_generator.sv изменить значение предела счетчика в цикле for в блоке BIG_TEST (есть подсказка в виде комментария)

---
>  Найденные ошибки выводятся в формате:
<ошибка> AT TIME: <время>
expected <ожидаемое значение>, got <полученное значение>`
в конце теста выводится результат по количеству отосланных и принятых пакетов с вердиктом
---
##### Обнаружены баги с channel, valid, startofpacket, endofpacket, размером data...

Для наглядной демонстрации отобрал 1 тест, для его запуска потребуется раскомментировать в make_sim.do первый тест:
*#FOUND_PROBLEM_CHANNEL*
*vsim -novopt -gTEST_CASE=0 top_tb*

 MONITOR: source channel wrong  AT TIME:     1035
EXPECTED      897, got      977
```
MONITOR: source start_of_packet wrong  AT TIME:     1035
EXPECTED        0, got        1
SCOREBOARD: DIFFERENT CHANNEL  AT TIME:     1035
EXPECTED      898, got      897
SCOREBOARD: DIFFERENT BETWEEN PACKET SIZE  AT TIME:     1035
EXPECTED        9, got     2489
```
По временной диаграмме видно, что изначальный канал не совпал. Монитор не следит за действиями драйвера и пишет пакет по SOP/EOP, поэтому тут есть различие в выводе EXPECTED и GOT у scoreboard и монитора, однако scoreboard сравнивает транзакцию от драйвера и монитора. Монитор предполагает, что channel при SOP является главным и пишет его в заголовок своей транзакции.
Видно, что в scoreboard канал не совпал, поэтому вывелось сообщение об ошибке. Эта ошибка обнаруживается, когда valid не всегда поднят у драйвера.

При этом явно видна проблема с SOP (с самого начала симуляции длинный лог...). SOP поднят, при этом EOP не поднимался вообще ни разу. Поэтому монитор собрал пакет с 2489 байтами, а отправлялись 2 словам в 8 и 1 байт одним пакетом. И все это время с valid менялся канал...

То есть valid так же некорректен у dut вместе с sop, а вместе с ним и data. EOP сработал только во время 1035, когда и был отправлен 2 кусочек пакета.

---
##### Обнаружен баг с endofpacket в случаях, когда размер пакета от 1 до 8 байт включительно.

Для наглядной демонстрации нужно запустить тест TEST_PLAIN, раскомментировав:
*vsim -novopt -gTEST_CASE=1 top_tb*

тест подразумевает запись возрастающих по размеру пакетов без пауз

в конце теста будет вывод:
```
driver sent         236 packets
monitor received         228 packets
```

8 пакетов просто не приняты, их не было (то есть сначала поднятый SOP, потом EOP, либо одновременно).

Во время 105 поднимется EOP и будет записан один большой пакет, (то есть все пакеты размером от 1 до 9 байт). Далее весь лог рушится

---
В конце всех тестов (кроме BIG_TEST, он достаточно рандомизирован) подаются рандомизированные входные данные при опущенном сигнале драйвера valid, при этом ready у sink'a меняется рандомно. В такой ситуации у DUT опять же подаются ложные SOP с valid и другими данными. 
